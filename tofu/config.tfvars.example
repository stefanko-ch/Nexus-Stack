# =============================================================================
# Nexus-Stack Configuration
# =============================================================================
# This file contains NON-SENSITIVE configuration only.
# Secrets are provided via environment variables (see .env.example)
#
# Setup:
#   1. Copy this file to config.tfvars
#   2. Copy .env.example to .env and add your secrets
#   3. Run 'source .env && make init'
#
# For CI/CD: Set secrets as GitHub Actions secrets (TF_VAR_*)
# =============================================================================

# =============================================================================
# Hetzner Cloud Server Settings
# =============================================================================

server_type     = "cax31"         # 4 vCPU, 8GB RAM (ARM)
server_location = "fsn1"          # Falkenstein, Germany
server_image    = "ubuntu-24.04"

# SSH keys (adjust paths if needed)
ssh_public_key_path  = "~/.ssh/id_ed25519.pub"
ssh_private_key_path = "~/.ssh/id_ed25519"

# =============================================================================
# Cloudflare Settings
# =============================================================================

# Get your Zone ID from: Cloudflare Dashboard → Your Domain → Overview (right sidebar)
cloudflare_zone_id = "YOUR_ZONE_ID_HERE"

# Your domain (must be managed in Cloudflare)
# Note: Resource names are derived from this (e.g., "nexus-your-domain-com")
domain = "your-domain.com"

# =============================================================================
# User Access
# =============================================================================
# NOTE: For GitHub Actions, set these as secrets:
#   gh secret set TF_VAR_admin_email --body "admin@example.com"
#   gh secret set TF_VAR_user_email --body "user@example.com"
# =============================================================================

# Admin email - full access including SSH
admin_email = "admin@example.com"

# Regular user email - all services except SSH (optional)
# user_email = "user@example.com"

# Admin username for services like Portainer, Uptime Kuma (optional, default: nexus)
# admin_username = "nexus"

# =============================================================================
# Services
# =============================================================================
# Add services here - each one gets automatic:
# - DNS record (subdomain.your-domain.com)
# - Cloudflare Tunnel routing
# - Zero Trust Access policy
#
# You still need to create stacks/<name>/docker-compose.yml for each service!
# =============================================================================

services = {
  it-tools = {
    enabled   = true
    subdomain = "it-tools"
    port      = 8080
    public    = false    # false = requires login, true = public access
  }

  portainer = {
    enabled   = true
    subdomain = "portainer"
    port      = 9090
    public    = false    # Docker management should always be protected
  }

  uptime-kuma = {
    enabled   = true
    subdomain = "uptime-kuma"
    port      = 3001
    public    = false
  }

  infisical = {
    enabled   = true
    subdomain = "infisical"
    port      = 8070
    public    = false    # Secret management - always protected
  }

  grafana = {
    enabled   = true
    subdomain = "grafana"
    port      = 3100
    public    = false    # Observability stack - always protected
  }

  info = {
    enabled   = true
    subdomain = "info"
    port      = 8090
    public    = false    # Landing page with service overview
  }

  kestra = {
    enabled   = true
    subdomain = "kestra"
    port      = 8085
    public    = false    # Workflow orchestration - always protected
  }

  metabase = {
    enabled   = true
    subdomain = "metabase"
    port      = 3000
    public    = false    # Business intelligence - always protected
  }
  
  # Example: Add more services like this:
  # excalidraw = {
  #   enabled   = true
  #   subdomain = "draw"
  #   port      = 8082
  #   public    = false
  # }
}
